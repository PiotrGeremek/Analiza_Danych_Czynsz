---
title: "Czynsz za mieszkania w Polsce"
author: "Miriam Nieslona, Piotr Geremek"
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown:
    self_contained: true
    thumbnails: true
    lightbox: true
    gallery: false
---

```{r Instalacja_pakietow, include=FALSE}
#Instalacja pakietÃ³w 

options(repos = c(CRAN = "https://cloud.r-project.org/"))
install.packages(c("rmdformats", "tidyverse", "dlookr", "editrules", "VIM", "deducorrect", "ISLR", "naniar", "visdat", "Amelia", "validate", "ggplot2", "mice", "finalfit", "GGally", "dplyr", "plotly", "gtsummary", "glue", "arsenal", "qwraps2", "table1", "moments", "ggstatsplot","viridis"))
library(rmdformats)
library(tidyverse)
library(dlookr)
library(editrules)
library(VIM)
library(deducorrect)
library(ISLR) 
library(naniar)
library(visdat)
library(Amelia)
library(validate)
library(ggplot2)
library(mice)
library(finalfit)
library(GGally)
library(dplyr)
library(plotly)
library(gtsummary)
library(glue)
library(arsenal)
library(qwraps2)
library(table1)
library(moments)
library(ggstatsplot)
library(viridis)
```

# *Wprowadzenie*

## Opis problemu

Celem raportu jest analiza czynnikÃ³w wpÅ‚ywajÄ…cych na wysokoÅ›Ä‡ czynszu w najwiÄ™kszych polskich miastach oraz porÃ³wnanie kosztÃ³w najmu w rÃ³Å¼nych wojewÃ³dztwach. Analiza pozwoli okreÅ›liÄ‡, gdzie czynsze sÄ… najwyÅ¼sze i najniÅ¼sze oraz co wpÅ‚ywa na ich wysokoÅ›Ä‡. Dodatkowo, raport bÄ™dzie zawieraÅ‚ wizualizacje ukazujÄ…ce zaleÅ¼noÅ›ci pomiÄ™dzy czynszem a poszczegÃ³lnymi zmiennymi, co pozwoli na lepsze zrozumienie mechanizmÃ³w ksztaÅ‚tujÄ…cych rynek wynajmu nieruchomoÅ›ci w Polsce.

## Dane

```{r wczytywanie_danych, include=FALSE}
knitr::opts_chunk$set(cache = TRUE)
wynajem_pdst_raw <- read.csv("apartments_rent_pl_2024_06.csv")
```

PodstawÄ… naszej analizy bÄ™dzie obszerna baza danych dotyczÄ…ca mieszkaÅ„ na wynajem, ktÃ³ra zawiera szczegÃ³Å‚owe informacje o poszczegÃ³lnych ofertach.

Nasza baza danych obejmuje takie informacje jak:

-   **Lokalizacja** â€“ miasto, wspÃ³Å‚rzÄ™dne geograficzne (szerokoÅ›Ä‡ i dÅ‚ugoÅ›Ä‡ geograficzna), oraz odlegÅ‚oÅ›Ä‡ od centrum.

-   **Charakterystyka mieszkania** â€“ typ budynku (np. blok mieszkalny, kamienica), powierzchnia w metrach kwadratowych, liczba pokoi, piÄ™tro oraz liczba piÄ™ter w budynku.

-   **Rok budowy** â€“ informacja o wieku budynku, jeÅ›li jest dostÄ™pna.

-   **BliskoÅ›Ä‡ infrastruktury** â€“ odlegÅ‚oÅ›Ä‡ od waÅ¼nych punktÃ³w usÅ‚ugowych, takich jak szkoÅ‚y, przychodnie, urzÄ™dy pocztowe, przedszkola, restauracje, uczelnie i apteki.

-   **Standard i wyposaÅ¼enie** â€“ stan mieszkania (np. premium, do remontu), materiaÅ‚ budynku, obecnoÅ›Ä‡ parkingu, balkonu, windy, ochrony oraz komÃ³rki lokatorskiej.

-   **Forma wÅ‚asnoÅ›ci** â€“ np. mieszkanie wÅ‚asnoÅ›ciowe, spÃ³Å‚dzielcze.

-   **Cena wynajmu** â€“ czynsz podany w zÅ‚otych.

# *Standaryzacja i przygotowanie danych do analizy*

## Braki danych

Zamieniamy puste wartosÄ‡i na "NA"

```{r na, echo=TRUE}
wynajem_pdst_raw[wynajem_pdst_raw == ''] <- NA
```

Sprawdzamy ile mamy brakÃ³w danych

```{r ile_brakow, echo=TRUE}
n_miss(wynajem_pdst_raw)
```

Sprawdzamy jaki % naszych danych, to braki danych

```{r %barakow, echo=TRUE}
prop_miss(wynajem_pdst_raw)
```

Warto sprawdziÄ‡, w przypadku jakiej zmiennej wystÄ™pujÄ™ najwiÄ™cej brakÃ³w

```{r gdzie_na, echo=TRUE}
miss_var_summary(wynajem_pdst_raw)
```

Jak widaÄ‡, w "condition" wystÄ™puje aÅ¼ 71,5% brakÃ³w danych. Wynika to z faktu, Å¼e w kolumnie tej wystÄ™pujÄ… jedynie wartoÅ›ci "premium" oraz braki danych. MoÅ¼emy wiÄ™c zaÅ‚oÅ¼yÄ‡, iÅ¼ brakujÄ…ce obserwacje, to tak naprawdÄ™ mieszkania "non-premium". PostepujÄ…c w taki sposÃ³b, wyeliminujemy znacznÄ… czÄ™Å›Ä‡ brakÃ³w danych.

```{r non_premium}
wynajem_pdst <- wynajem_pdst_raw
wynajem_pdst$condition[is.na(wynajem_pdst$condition)] <- "non_premium"
prop_miss(wynajem_pdst)
```

Jak widaÄ‡ z prawie 6,4% brakÃ³w danych, tym sposobem mamy ich jedynie 3,8%

```{r gdzie_na_duzo, echo=FALSE}
vis_miss(wynajem_pdst, sort = TRUE)
```

Wiele brakÃ³w danych, mamy rÃ³wnieÅ¼ w m.in. materiaÅ‚ach budynku, roku budowy, formie wÅ‚asnoÅ›ci mieszkania oraz piÄ™trze. Niestety tych wartoÅ›ci nie moÅ¼emy w Å¼aden sposÃ³b uzupeÅ‚niÄ‡ rÄ™cznie. W nastepnych krokach posÅ‚uÅ¼ymy siÄ™ imputacjÄ…

```{r czestochowa_braki, echo=FALSE}
gg_miss_fct(wynajem_pdst, fct = city) #braki w zaleznosci od miasta
```

Co ciekawe, najwiÄ™cej brakÃ³w pod kÄ…tem roku budowy wystÄ™pujÄ™ w CzÄ™stochowie, co moÅ¼e byÄ‡ spowodowane tym, Å¼e jest to miasto z duÅ¼Ä… liczba starszych budynkÃ³w, w ktÃ³rych to przypadku rok budowy czÄ™sto jest niezanany lub teÅ¼ pomijany przez wÅ‚aÅ›cicieli w ogÅ‚oszeniach.

## Obserwacje odstajÄ…ce

```{r boxploty_odstajace, eval=FALSE, include=FALSE}
boxplot(wynajem_pdst$squareMeters)
boxplot(wynajem_pdst$rooms)
boxplot(wynajem_pdst$floor)
boxplot(wynajem_pdst$floorCount)
boxplot(wynajem_pdst$buildYear)
boxplot(wynajem_pdst$latitude)
boxplot(wynajem_pdst$longitude)
boxplot(wynajem_pdst$centreDistance)
boxplot(wynajem_pdst$poiCount)
boxplot(wynajem_pdst$schoolDistance)
boxplot(wynajem_pdst$clinicDistance)
boxplot(wynajem_pdst$postOfficeDistance)
boxplot(wynajem_pdst$kindergartenDistance)
boxplot(wynajem_pdst$restaurantDistance)
boxplot(wynajem_pdst$collegeDistance)
boxplot(wynajem_pdst$pharmacyDistance)
boxplot(wynajem_pdst$price)
```

```{r odstajace_min_max, echo=TRUE}
summary(wynajem_pdst)
```

ZarÃ³wno stworzenie boxplotÃ³w dla danych oraz zbadanie ich za pomocÄ… wartoÅ›ci minimalnych i maksymalnych, nie wykazaÅ‚o Å¼adnych znaczÄ…cych obserwacji odstajÄ…cych.

```{r city_odstajace, echo=TRUE}
unique(wynajem_pdst$city)
```

RÃ³wnieÅ¼ przy sprawdzaniu miast widzimy, Å¼e nie ma Å¼adnej odstajÄ…cej/niepoprawnie zapisanej wartoÅ›ci.

## Walidacja danych

```{r reguly, include=FALSE}
reguly <- editset(c(
  "price>0",
  "pharmacyDistance>0",
  "collegeDistance>0",
  "restaurantDistance>0",
  "kindergartenDistance>0",
  "postOfficeDistance>0",
  "clinicDistance>0",
  "schoolDistance>0",
  "floorCount>=0",
  "centreDistance>0",
  "floor>=0",
  "rooms>0",
  "squareMeters>0",
  "buildYear>0",
  "poiCount>=0",
  "latitude>=0",
  "longitude>=0"
))
```

```{r walidacja, echo=TRUE}
summary(violatedEdits(reguly,wynajem_pdst))
bledy <- violatedEdits(reguly,wynajem_pdst)
plot(bledy)
```

Po zwalidowaniu danych nie wystÄ™pujÄ… Å¼adne bÅ‚Ä™dy, co oznacza, Å¼e moÅ¼emy przejÅ›c do ich imputacji

## Imputacja danych

```{r imputacja}
library(VIM)
czyste_dane <- hotdeck(wynajem_pdst)
```

Upewniamy siÄ™, czy po imputacji na pewno nie mamy Å¼adnych brakÃ³w danych, czy wszystko zadziaÅ‚aÅ‚o poprawnie.

```{r sprawdzenie_imput, echo=TRUE}
n_miss(czyste_dane)
```

```{r wykres_imput, echo=FALSE}
vis_miss(czyste_dane)
```

```{r zapisane_czyste, include=FALSE}
write.csv(czyste_dane, "oczyszczone_dane.csv", row.names = FALSE)
```

# *Wizualizacja danych*

Na poczÄ…tku zamieniamy wartoÅ›ci "yes", "no", w przypadku niektÃ³rych zmiennych na TRUE i FALSE, co uÅ‚atwi nam interpretacje wykresÃ³w

```{r true_false, echo=TRUE}
dane_do_wiz <- read.csv("oczyszczone_dane.csv")
dane_do_wiz <- dane_do_wiz %>%
  mutate(  
    hasParkingSpace = ifelse(hasParkingSpace == "yes", TRUE, FALSE),  
    hasBalcony = ifelse(hasBalcony == "yes", TRUE, FALSE),  
    hasElevator = ifelse(hasElevator == "yes", TRUE, FALSE),  
    hasSecurity = ifelse(hasSecurity == "yes", TRUE, FALSE),
    hasStorageRoom = ifelse(hasStorageRoom == "yes", TRUE, FALSE)
  )
```

## Wszystkie miasta

```{r histogram_cena_all, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(dane_do_wiz, aes(x = price)) +
  geom_histogram(binwidth = 500, fill = "blue", color = "black") +
  labs(title = "Histogram Ceny wynajmu mieszkaÅ„", x = "Cena wynajmu", y = "Liczba mieszkaÅ„")
```

TworzÄ…c histogram **ceny wynajmu** mieszkaÅ„ dla wszystkich miast, moÅ¼emy zauwaÅ¼yÄ‡, iÅ¼ **wiÄ™kszoÅ›Ä‡ ofert** wynajmy mieszkaÅ„ koncentruje siÄ™ **w przedziale 1800-3800 PLN**. Tanie mieszkania (do 1800 PLN) sÄ… rzadkoÅ›ciÄ…. W przedziale powyÅ¼ej 3800 PLN, liczba ofert stopniowo maleje

```{r cena_od_miasta, echo=FALSE}
ggplot(dane_do_wiz, aes(x = city, y = price)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  labs(
    title = "Cena wynajmu mieszkaÅ„ w zaleÅ¼noÅ›ci od miasta",
    x = "Miasto",
    y = "Cena wynajmu"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

MoÅ¼na jednak zauwaÅ¼yÄ‡, Å¼e dla Warszawy widoczna jest znaczÄ…ca rÃ³Å¼nica w medianie i rozkÅ‚adzie cen wynajmu, w porÃ³wnaniu do pozostaÅ‚ych miast.

Dodatkowo w **Warszawie** wystÄ™puje **duÅ¼a liczba wartoÅ›ci odstajÄ…cych**, co wskazuje na obecnoÅ›Ä‡ bardzo drogich mieszkaÅ„ na wynajem, co moÅ¼e byÄ‡ zwiÄ…zane z luksusowymi apartamentami, prestiÅ¼owymi lokalizacjami oraz wiÄ™kszym zrÃ³Å¼nicowaniem ofert w stolicy.

Oznacza to, Å¼e **wÅ‚Ä…czenie Warszawy do wspÃ³lnej analizy** z innymi miastami **moÅ¼e zaburzaÄ‡ ogÃ³lne wnioski**, poniewaÅ¼ podnosi wartoÅ›ci statystyczne, takie jak Å›rednia, mediana i kwartyle. MoÅ¼e to prowadziÄ‡ do bÅ‚Ä™dnej interpretacji rynku wynajmu w pozostaÅ‚ych miastach, sugerujÄ…c wyÅ¼sze ceny niÅ¼ rzeczywistoÅ›Ä‡.

Dlatego, aby uzyskaÄ‡ bardziej reprezentatywne wyniki, konieczne jest **oddzielne przeanalizowanie** Warszawy oraz pozostaÅ‚ych miast.

## Bez Warszawy

```{r bez_wwa, include=FALSE}
dane_do_wiz_bez_wwa <- dane_do_wiz %>%
  filter(city != "warszawa")
```

```{r bez_wwa_his, echo=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = price)) +
  geom_histogram(binwidth = 500, fill = "blue", color = "black") +
  labs(title = "Histogram Ceny wynajmu mieszkaÅ„", x = "Cena wynajmu", y = "Liczba mieszkaÅ„")
```

WidaÄ‡, Å¼e **po usuniÄ™ciu Warszawy** z analizy, przedziaÅ‚ cen za wynajem prezentuje siÄ™ inaczej. WiÄ™kszoÅ›c ofert koncentruje siÄ™ teraz **w przedziale 1250-3500 PLN.** WystÄ™puje wiÄ™ksza liczba tanich mieszkaÅ„, a z kolei ceny za mieszkania powyÅ¼ej 7500 PLN sÄ… praktycznie niespotykane.

```{r bezwwa, echo=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = city, y = price)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  labs(
    title = "Cena wynajmu mieszkaÅ„ w zaleÅ¼noÅ›ci od miasta",
    x = "Miasto",
    y = "Cena wynajmu"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Widzimy, Å¼e **najwyÅ¼sze ceny wynajmu mieszkaÅ„ sÄ… w Gdyni, Krakowie, GdaÅ„sku i WrocÅ‚awiu**. WynikajÄ… one z lokalnych czynnikÃ³w, takich jak atrakcyjnoÅ›Ä‡ miasta, popyt na luksusowe nieruchomoÅ›ci i ograniczona podaÅ¼.

Co ciekawe, w przypadku Krakowa, Pozania oraz WrocÅ‚awia widzimy najwiÄ™cej odstajÄ…cych wartoÅ›ci co sugeruje, iÅ¼ w tych miastach jest widoczna **przepaÅ›Ä‡ miÄ™dzy standardowymi, a luksusowymi mieszkaniami**. Rynek nieruchomoÅ›ci w tych miastach jest silnie zrÃ³Å¼nicowany.

**Luksusowe mieszkania** sÄ… skierowane do zamoÅ¼niejszych najemcÃ³w, ktÃ³rzy sÄ… gotowi pÅ‚aciÄ‡ wiÄ™cej za lokalizacjÄ™, standard i udogodnienia.

**Standardowe mieszkania** sÄ… dostÄ™pne dla szerszego grona najemcÃ³w, ale ich ceny sÄ… znacznie niÅ¼sze, co tworzy wyraÅºnÄ… rÃ³Å¼nicÄ™ miÄ™dzy segmentami rynku.

### Liczba pokoi

```{r pokoje_bezwwa, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = as.factor(rooms), y = price)) +
  geom_boxplot(fill = "orange", color = "black") +
  labs(title = "Cena wynajmu a liczba pokoi", x = "Liczba pokoi", y = "Cena wynajmu")
```

```{r cena_pokoje_bezwwa, echo=FALSE, message=FALSE, warning=FALSE}
avg_price_by_rooms <- dane_do_wiz_bez_wwa %>%
  group_by(rooms) %>%
  summarise(mean_price = mean(price, na.rm = TRUE))
ggplot(avg_price_by_rooms, aes(x = rooms, y = mean_price)) +
  geom_line(color = "blue", size = 1) +
  geom_point(color = "red", size = 3) +
  labs(
    title = "Åšrednia Cena wynajmu mieszkaÅ„ w zaleÅ¼noÅ›ci od liczby pokoi",
    x = "Liczba pokoi",
    y = "Åšrednia Cena wynajmu"
  ) +
  theme_minimal()
```

GÅ‚ownym wnioskiem jest oczywisty fakt, **iÅ¼ wynajem mieszkaÅ„ z wiÄ™kszÄ… liczbÄ… pokoi jest droÅ¼szy**. Dodatkowo moÅ¼na zauwaÅ¼yÄ‡, Å¼e dla mieszkaÅ„ z 2+ pokojami ceny sÄ… bardzo zrÃ³Å¼nicowane, co widaÄ‡ po szerokoÅ›ci pudeÅ‚ek i iloÅ›ci wartoÅ›ci odstajÄ…cych (np. luksusowe mieszkania)

### Powierzchnia

```{r powierzchnia_bezwwa, echo=FALSE, message=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = squareMeters, y = price)) +
  geom_point(alpha = 0.5, color = "blue") +
  geom_smooth(method = "loess", color = "red", se = TRUE) +
  labs(
    title = "Cena wynajmu w zaleÅ¼noÅ›ci od powierzchni mieszkania (z liniÄ… trendu)",
    x = "Powierzchnia mieszkania (mÂ²)",
    y = "Cena wynajmu"
  ) +
  theme_minimal()
```

Linia trendu na wykresie wskazuje na ogÃ³lnÄ… tendencjÄ™ wzrostowÄ… ceny wynajmu wraz ze wzrostem powierzchni mieszkania. Oznacza to, Å¼e **wiÄ™ksze mieszkania majÄ… zazwyczaj wyÅ¼sze ceny wynajmu.**

```{r cenawyzszametraz_bezwwa, echo=FALSE}
dane_do_wiz_bez_wwa_m2 <- dane_do_wiz_bez_wwa %>%
  mutate(size_bins = cut(squareMeters, breaks = c(0, 30, 60, 90, 120, Inf),
                         labels = c("0-30", "31-60", "61-90", "91-120", "120+")))

ggplot(dane_do_wiz_bez_wwa_m2, aes(x = size_bins, y = price)) +
  geom_boxplot(fill = "lightblue") +
  labs(
    title = "Cena wynajmu w przedziaÅ‚ach powierzchni mieszkania",
    x = "PrzedziaÅ‚y powierzchni (mÂ²)",
    y = "Cena wynajmu"
  ) +
  theme_minimal()
```

```{r podzial_powierchnia_bezwwa, echo=FALSE, message=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = squareMeters, y = price)) +
  geom_point(alpha = 0.5, color = "blue") +
  facet_wrap(~city) +
  geom_smooth(method = "lm", color = "red", se = TRUE) +
  labs(
  title = "Cena wynajmu w zaleÅ¼noÅ›ci od powierzchni mieszkania dla rÃ³Å¼nych miast",
  x = "Powierzchnia mieszkania (mÂ²)",
  y = "Cena wynajmu"
) +
  theme_minimal()
```

PowyÅ¼sze wykresy przedstawiajÄ…ce cenÄ™ wynajmu mieszkania, w zaleÅ¼noÅ›ci od powierzchni, wraz z liniÄ… trendu, dla konkretnych miast, powierdzajÄ…, iÅ¼ **w kaÅ¼dym z miast cena roÅ›nie wraz ze wzrostem powierzchni mieszkania**.

Co ciekawe, wykres ten pozwala nam zaobserwowaÄ‡ **jak rÃ³Å¼niÄ… siÄ™ metraÅ¼e mieszkaÅ„ w kaÅ¼dym z miast**. I tak np. w Radomiu praktycznie nie wystÄ™pujÄ… miesta powyÅ¼ej 75 m2, natomiast w Krakowie powierzchnie mieszkaÅ„ dochodzÄ… nawet do 150 m2.

### Typ budynku

```{r typbudynku_bezwwa, echo=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = price)) +
  geom_histogram(binwidth = 500, fill = "blue", color = "black", alpha = 0.6) +
  facet_wrap(~ type) +
  labs(title = "RozkÅ‚ad cen wedÅ‚ug typu budynku", x = "Cena wynajmu", y = "Liczba mieszkaÅ„")
```

Na postawie histogramÃ³w dla konkretnych typÃ³w budynkÃ³w, moÅ¼emy zauwaÅ¼yÄ‡, iÅ¼ ceny wynajmu nie rÃ³Å¼niÄ… siÄ™ znaczÄ…co. **NajwiÄ™cej droÅ¼szych mieszkaÅ„ to budynki apartamentowe**, co wynika z ich wysokiego standardu oraz z reguÅ‚y wielu udogodnieÅ„. Co ciekawe, widaÄ‡ bardzo duÅ¼Ä… rÃ³Å¼nice w liczbie konkretnych typÃ³w budynkÃ³w. **NajwiÄ™cej jest blokÃ³w mieszkalnych**, co moÅ¼e wynikaÄ‡ z faktu, iÅ¼ byÅ‚y masowo budowane w XX wieku, sÄ… taÅ„sze w konstrukcji i zawierajÄ… duÅ¼Ä… liczbÄ™ mieszkaÅ„ w jednym budynku. Z kolei **kamienic jest najmniej**, poniewaÅ¼ sÄ… to starsze budynki, a ich liczba jest ograniczona ze wzglÄ™dÃ³w historycznych i przestrzennych.

### Balkon

```{r balkon_bezwwa, echo=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = as.factor(hasBalcony), y = price)) +
  geom_boxplot(fill = "lightblue") +
  labs(title = "Cena wynajmu a dostÄ™pnoÅ›Ä‡ balkonu", x = "Czy jest balkon?", y = "Cena wynajmu") +
  coord_flip()
```

MoÅ¼na zauwaÅ¼yÄ‡, iÅ¼ **ceny wynajmu mieszkaÅ„, ktÃ³re posiadajÄ… balkon, sÄ… delikatnie wiÄ™ksze**, niÅ¼ mieszkaÅ„ bez balkonÃ³w.

### Parking

```{r parking_bezwwa, echo=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = as.factor(hasParkingSpace), y = price)) +
  geom_boxplot(fill = "cyan") +
  labs(title = "Cena wynajmu a dostÄ™pnoÅ›Ä‡ parkingu", x = "Czy jest parking?", y = "Cena wynajmu") +
  coord_flip()
```

Podobnie ma siÄ™ sprawa w przypadku parkingu. **Mieszkania, ktÃ³re zapewniajÄ… miejsce parkingowe sÄ… droÅ¼sze** od tych niezapewniajÄ…cych parkingu.

```{r paktingimiasta_bezwwa, echo=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = city, fill = as.factor(hasParkingSpace))) +
  geom_bar(position = "fill") +
  scale_fill_brewer(palette = "Set3") +
  labs(
    title = "DostÄ™pnoÅ›Ä‡ parkingu w rÃ³Å¼nych miastach",
    x = "Miasto",
    y = "Procent mieszkaÅ„",
    fill = "Czy jest parking"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Na powyÅ¼szym wykresie moÅ¼emy zaobserwowaÄ‡ dostÄ™pnoÅ›Ä‡ parkingÃ³w w mieszkaniach w zaleÅ¼noÅ›ci od miasta. Co ciekawe **w CzÄ™stochowie oraz Gdyni mniej niÅ¼ 1/5 mieszkaÅ„ oferuje miejsce parkingowe**

### Winda

```{r winda_bezwwa, echo=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = as.factor(hasElevator), y = price)) +
  geom_boxplot(fill = "cyan") +
  labs(title = "Cena wynajmu a dostÄ™pnoÅ›Ä‡ windy", x = "Czy jest winda?", y = "Cena wynajmu") +
  coord_flip()
```

RÃ³wnieÅ¼ winda ma wpÅ‚yw na cenÄ™ mieszkania. **Budynki z windÄ… sÄ… droÅ¼sze**, od tych bez niej

### Ochrona

```{r ochrona_bezwwa, echo=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = as.factor(hasSecurity), y = price)) +
  geom_boxplot(fill = "cyan") +
  labs(title = "Cena wynajmu a istnienie ochrony", x = "Czy jest ochrona?", y = "Cena wynajmu") +
  coord_flip()
```

RÃ³wnieÅ¼ **obecnoÅ›c ochrony w budynku, wpÅ‚ywa na wyÅ¼szÄ… cenÄ™ wynajmu.**

### Piwnica

```{r piwnica_bezwwa, echo=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = as.factor(hasStorageRoom), y = price)) +
  geom_boxplot(fill = "cyan") +
  labs(title = "Cena wynajmu a dostÄ™pnoÅ›Ä‡ piwnicy", x = "Czy jest piwnica?", y = "Cena wynajmu") +
  coord_flip()
```

Co ciekawe, w przypadku piwnicy, to **mieszkania bez niej, z reguÅ‚y sÄ… droÅ¼sze od mieszkaÅ„ z piwnicÄ….** MoÅ¼e to wynikaÄ‡ z faktu, iÅ¼ w nowych inwestycjach piwnice sÄ… czÄ™sto pomijane na rzecz innych rozwiÄ…zaÅ„, takich jak dodatkowe miejsca parkingowe lub wspÃ³lne przestrzenie rekreacyjne, a takie budynki, jak juÅ¼ zauwaÅ¼yliÅ›my wczeÅ›niej, sÄ… zazwyczaj droÅ¼sze od starych kamienic.

### Wszystkie dodatkowe udogodnienia

```{r udogodnienia_bezwwa, echo=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = interaction(hasBalcony, hasParkingSpace, hasElevator, hasSecurity, hasStorageRoom), y = price)) +
  geom_boxplot(fill = "lightblue") +
  labs(
    title = "Cena wynajmu a cechy mieszkania (balkon, parking, winda, ochrona, piwnica)",
    x = "Cecha mieszkania",
    y = "Cena wynajmu"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Wykres prezentuje wszystkie moÅ¼liwe **kombinacje dodatkowych udogodnieÅ„** w mieszkaniach. DziÄ™ki niemu moÅ¼emy nawuaÅ¼yÄ‡, Å¼e tak naprawdÄ™, **Å¼adna z nich nie ma znaczÄ…cego wpÅ‚ywu na cenÄ™ mieszkania**

### Stan mieszkania

```{r stanmieszkania_bezwwa, echo=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = condition, y = price)) +
  geom_boxplot(fill = "salmon") +
  labs(title = "Cena wynajmu a stan mieszkania", x = "Stan mieszkania", y = "Cena wynajmu") + 
  coord_flip()
```

OczywiÅ›cie **im wyÅ¼szy standard mieszkania, tym wyÅ¼sza cena wynajmu.**

### MateriaÅ‚ budynku

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = buildingMaterial, y = price)) +
  geom_boxplot(fill = "grey") +
  labs(title = "Cena wynajmu a materiaÅ‚ budynku", x = "MateriaÅ‚ budynku", y = "Cena wynajmu") +
  coord_flip()
```

Co ciekawe, **budynki zbudowane z cegÅ‚y sÄ… z reguÅ‚y droÅ¼sze od tych z pÅ‚yt betonowych**. MoÅ¼e to wynikaÄ‡ z rÃ³Å¼nych czynnikÃ³w. Budynki z cegÅ‚y sÄ… czÄ™sto lepiej utrzymane i majÄ… wyÅ¼szy standard wykoÅ„czenia, co wpÅ‚ywa na wyÅ¼szÄ… cenÄ™ wynajmu. Dodatkowo sÄ… czÄ™sto postrzegane jako bardziej prestiÅ¼owe i trwaÅ‚e, co rÃ³wnieÅ¼ moÅ¼e wpÅ‚ywaÄ‡ na cenÄ™.

### OdlegÅ‚oÅ›Ä‡ od centrum

```{r odl_miasta_bezwwa, echo=FALSE, message=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = centreDistance, y = price, color = city)) +
  geom_smooth(method = "loess", se = FALSE) +
  labs(
    title = "Cena wynajmu a odlegÅ‚oÅ›Ä‡ od centrum w rÃ³Å¼nych miastach",
    x = "OdlegÅ‚oÅ›Ä‡ od centrum (km)",
    y = "Cena wynajmu",
    color = "Miasto"
  ) +
  theme_minimal()
```

Wykres pokazuje, Å¼e **ceny wynajmu sÄ… najwyÅ¼sze w centrach miast** i spadajÄ… wraz z odlegÅ‚oÅ›ciÄ… od centrum.

RÃ³Å¼nice w cenach miÄ™dzy centrum a obrzeÅ¼ami sÄ… najbardziej wyraÅºne w duÅ¼ych miastach, takich jak Gdynia, Katowice, GdaÅ„sk, niÅ¼ w mniejszych miastach, takich jak Bydgoszcz czy Lublin.

Co ciekawe, na wykresie moÅ¼emy zaobserwowaÄ‡ **odstajÄ…ce punkty** lub teÅ¼ **zupeÅ‚nie odwrotnÄ… tendencjÄ™ (np. ÅÃ³dÅº)**, gdzie im dalej od centrum, tym wyÅ¼sze ceny. Odchylenia te mogÄ… wskazywaÄ‡ na specyficzne lokalizacje lub luksusowe osiedla, ktÃ³re majÄ… wyÅ¼sze ceny niÅ¼ typowe mieszkania w danej odlegÅ‚oÅ›ci od centrum.

### PiÄ™tro

```{r pietro1_bezwwa, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = factor(floor), y = price)) +
  geom_boxplot(fill = "lightblue") +
  labs(
    title = "Cena wynajmu w zaleÅ¼noÅ›ci od piÄ™tra",
    x = "PiÄ™tro",
    y = "Cena wynajmu"
  ) +
  theme_minimal()
```

```{r pietro2_bezwwa, echo=FALSE, message=FALSE, warning=FALSE}
avg_price_floor <- dane_do_wiz_bez_wwa %>%
  group_by(floor) %>%
  summarise(mean_price = mean(price, na.rm = TRUE))

ggplot(avg_price_floor, aes(x = floor, y = mean_price)) +
  geom_line(color = "darkgreen", size = 1) +
  geom_point(color = "orange", size = 2) +
  labs(
    title = "Åšrednia Cena wynajmu w zaleÅ¼noÅ›ci od piÄ™tra",
    x = "PiÄ™tro",
    y = "Åšrednia Cena wynajmu"
  ) +
  theme_minimal()
```

JeÅ›li chodzi o wypÅ‚yw piÄ™tra na cenÄ™ wynajmu mieszkania, to moÅ¼emy zauwaÅ¼yÄ‡, Å¼e **ceny wynajmu sÄ… silnie zaleÅ¼ne od piÄ™tra**, ale trend nie jest liniowy.

-   **Do 5 piÄ™tra** ceny za mieszkanie rosnÄ…, co moÅ¼e wynikaÄ‡ z atrakcyjnoÅ›ci tych piÄ™ter dla najemcÃ³w (nie sÄ… za nisko - mniejsze ryzyko kradzieÅ¼y, ale rÃ³wnieÅ¼ nie sÄ… za wysoko co moÅ¼e wydÅ‚uÅ¼aÄ‡ czas dotarcia na piÄ™tro)

-   **PiÄ™tra 5-11** tracÄ… na atrakcyjnoÅ›ci, z powodu wÅ‚aÅ›nie omÃ³wionego wyÅ¼ej utrudnienia zwiÄ…zanego z dÅ‚uÅ¼szym czasem dotarcia do mieszkania, czy teÅ¼ uciÄ…Å¼liwoÅ›ci w przypadku braku/awarii windy.

-   Ceny za **piÄ™tra 12 i wyÅ¼ej** sÄ… najwyÅ¼sze, co moÅ¼e wynikaÄ‡ z faktu, iÅ¼ czÄ™sto sa one postrzegane jako luksusowe. SÄ… skierowane do zamoÅ¼niejszych najemcÃ³w, ktÃ³rzy sÄ… gotowi zapÅ‚aciÄ‡ wiÄ™cej za wyjÄ…tkowe widoki, prywatnoÅ›Ä‡ i prestiÅ¼. Dodatkowo, tak wysokie piÄ™tra nie wystÄ™pujÄ… z reguÅ‚y w starych kamieniacach czy blokach, a w apartamentowcach, ktÃ³re oferujÄ… wyÅ¼szy standard i to wÅ‚aÅ›nie to, moÅ¼e byÄ‡ przyczyna wyÅ¼szych cen wynajmu.

```{r pietra_histogram_bezwwa, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(dane_do_wiz_bez_wwa, aes(x = factor(floor))) +
  geom_histogram(stat = "count", fill = "skyblue", color = "black") +
  labs(
    title = "Liczba ofert mieszkaÅ„ na piÄ™trze",
    x = "PiÄ™tro",
    y = "Liczba mieszkaÅ„"
  ) +
  theme_minimal()
```

PowyÅ¼szy wykres potwierdza, jak niewiele mieszkaÅ„ znajduje siÄ™ na piÄ™trach 11 i wyÅ¼ej

### Korelacja

```{r korelacja_bezwwa, echo=FALSE}
ggcorr(
  data = dane_do_wiz_bez_wwa %>% select(where(is.numeric)),
  method = c("pairwise.complete.obs", "pearson"),
  label = TRUE
) +
  theme(
    axis.text.x = element_text(hjust = 1),  # PrzesuniÄ™cie etykiet na osi X
    axis.text.y = element_text(hjust = 1)   # PrzesuniÄ™cie etykiet na osi Y
  )
```

Tylko dwie zmienne â€“ **liczba pokoi (rooms)** i **powierzchnia (squareMeters)** â€“ wykazujÄ… **silnÄ… korelacjÄ™ (dodatniÄ…) z cenÄ… wynajmu**.

WiÄ™kszoÅ›Ä‡ pozostaÅ‚ych zmiennych nie wykazuje silnej korelacji ani dodatniej, ani ujemnej z cenÄ…. Oznacza to, Å¼e wpÅ‚yw tych czynnikÃ³w na cenÄ™ jest mniej znaczÄ…cy lub bardziej zÅ‚oÅ¼ony.

**Zmienne opisujÄ…ce odlegÅ‚oÅ›Ä‡ od rÃ³Å¼nych obiektÃ³w** (np. restaurantDistance, schoolDistance, parkDistance) sÄ… **mocno skorelowane miÄ™dzy sobÄ….** Oznacza to, Å¼e jeÅ›li mieszkanie jest blisko jednego obiektu (np. restauracji), prawdopodobnie jest teÅ¼ blisko innych (np. szkoÅ‚y czy parku).

## Warszawa

```{r warszawka, include=FALSE}
dane_do_wiz_wwa <- dane_do_wiz %>%
  filter(city == "warszawa")
```

```{r historgram_wwwa, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = price)) +
  geom_histogram(binwidth = 500, fill = "blue", color = "black") +
  labs(title = "Histogram Ceny wynajmu mieszkaÅ„", x = "Cena wynajmu", y = "Liczba mieszkaÅ„")
```

Widzimy, Å¼e rozkÅ‚ad ceny wynajmu mieszkaÅ„ w Warszawie jest juÅ¼ znacznie szerszy. **Ceny dochodzÄ… nawet do 20000 PLN.**

### Liczba pokoi

```{r pokoje)wwa, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = as.factor(rooms), y = price)) +
  geom_boxplot(fill = "orange", color = "black") +
  labs(title = "Cena wynajmu a liczba pokoi", x = "Liczba pokoi", y = "Cena wynajmu")
```

```{r pokoje_wwa_2, echo=FALSE, message=FALSE, warning=FALSE}
avg_price_by_rooms <- dane_do_wiz_wwa %>%
  group_by(rooms) %>%
  summarise(mean_price = mean(price, na.rm = TRUE))
ggplot(avg_price_by_rooms, aes(x = rooms, y = mean_price)) +
  geom_line(color = "blue", size = 1) +
  geom_point(color = "red", size = 3) +
  labs(
    title = "Åšrednia Cena wynajmu mieszkaÅ„ w zaleÅ¼noÅ›ci od liczby pokoi",
    x = "Liczba pokoi",
    y = "Åšrednia Cena wynajmu"
  ) +
  theme_minimal()
```

### Powierzchnia

```{r powierzchnia_wwa, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = squareMeters, y = price)) +
  geom_point(alpha = 0.5, color = "blue") +
  geom_smooth(method = "loess", color = "red", se = TRUE) +
  labs(
    title = "Cena wynajmu w zaleÅ¼noÅ›ci od powierzchni mieszkania (z liniÄ… trendu)",
    x = "Powierzchnia mieszkania (mÂ²)",
    y = "Cena wynajmu"
  ) +
  theme_minimal()
```

```{r powiechnia_wwa_2, echo=FALSE, message=FALSE, warning=FALSE}
dane_do_wiz_wwa_m2 <- dane_do_wiz_wwa %>%
  mutate(size_bins = cut(squareMeters, breaks = c(0, 30, 60, 90, 120, Inf),
                         labels = c("0-30", "31-60", "61-90", "91-120", "120+")))

ggplot(dane_do_wiz_wwa_m2, aes(x = size_bins, y = price)) +
  geom_boxplot(fill = "lightblue") +
  labs(
    title = "Cena wynajmu w przedziaÅ‚ach powierzchni mieszkania",
    x = "PrzedziaÅ‚y powierzchni (mÂ²)",
    y = "Cena wynajmu"
  ) +
  theme_minimal()
```

### Typ budynku

```{r wyp_budynku_wwa, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = price)) +
  geom_histogram(binwidth = 500, fill = "blue", color = "black", alpha = 0.6) +
  facet_wrap(~ type) +
  labs(title = "RozkÅ‚ad cen wedÅ‚ug typu budynku", x = "Cena wynajmu", y = "Liczba mieszkaÅ„")
```

ZaleÅ¼noÅ›Ä‡i w przypadku wpÅ‚ywu liczby pokoi, powierzchni oraz typu budynku na cene wynajmu, ksztaÅ‚tujÄ… siÄ™ w Warszawie pododbnie jak w pozostaÅ‚ych polskich miastach.\
Jedyna zaobserwowana znaczÄ…ca rÃ³Å¼nica, to widoczna przewaga w liczbie blokÃ³w mieszkaniowych. Dodatkowo co ciekawe w ich przypadku **bardzo mocno dominuje jeden konkretny przedziaÅ‚ cenowy,** co moÅ¼e wynikaÄ‡ z podobnego standardu mieszkaÅ„ oraz duÅ¼ej podaÅ¼y mieszkaÅ„ w blokach, co utrzymuje ceny na podobnym poziomie.

### Balkon

```{r balkon_wwa, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = as.factor(hasBalcony), y = price)) +
  geom_boxplot(fill = "lightblue") +
  labs(title = "Cena wynajmu a dostÄ™pnoÅ›Ä‡ balkonu", x = "Czy jest balkon?", y = "Cena wynajmu") +
  coord_flip()
```

### Parking

```{r parking_wwa, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = as.factor(hasParkingSpace), y = price)) +
  geom_boxplot(fill = "cyan") +
  labs(title = "Cena wynajmu a dostÄ™pnoÅ›Ä‡ parkingu", x = "Czy jest parking?", y = "Cena wynajmu") +
  coord_flip()
```

```{r paringile_wwa, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = city, fill = as.factor(hasParkingSpace))) +
  geom_bar(position = "fill") +
  scale_fill_brewer(palette = "Set3") +
  labs(
    title = "DostÄ™pnoÅ›Ä‡ parkingu w Warszawie",
    x = "Miasto",
    y = "Procent mieszkaÅ„",
    fill = "Czy jest parking"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

### Winda

```{r winda_wwa, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = as.factor(hasElevator), y = price)) +
  geom_boxplot(fill = "cyan") +
  labs(title = "Cena wynajmu a dostÄ™pnoÅ›Ä‡ windy", x = "Czy jest winda?", y = "Cena wynajmu") +
  coord_flip()
```

### Ochrona

```{r ochorna_wwa, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = as.factor(hasSecurity), y = price)) +
  geom_boxplot(fill = "cyan") +
  labs(title = "Cena wynajmu a istnienie ochrony", x = "Czy jest ochrona?", y = "Cena wynajmu") +
  coord_flip()
```

**DostÄ™p do balkonu, parkingu, ochrony oraz windy**, rÃ³wnieÅ¼ w przypadku Warszawy wpÅ‚ywa na cenÄ™ mieszkania, jednak **wpÅ‚yw ten jest znacznie mniejszy** niÅ¼ w przypadku pozostaÅ‚ych polskich miast.

### Piwnica

```{r piwnica_wwa, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = as.factor(hasStorageRoom), y = price)) +
  geom_boxplot(fill = "cyan") +
  labs(title = "Cena wynajmu a dostÄ™pnoÅ›Ä‡ piwnicy", x = "Czy jest piwnica?", y = "Cena wynajmu") +
  coord_flip()
```

Tak samo jak w przypadku innych miast, odwrotnie niÅ¼ w przypadku innych udogodnieÅ„, mieszkania bez piwnicy sÄ… droÅ¼sze. Jednak ponownie, udogodnienie to ma duÅ¼o mniejszy wpÅ‚yw na cenÄ™.

### Stan mieszkania

```{r tanmieskzania_wwa, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = condition, y = price)) +
  geom_boxplot(fill = "salmon") +
  labs(title = "Cena wynajmu a stan mieszkania", x = "Stan mieszkania", y = "Cena wynajmu") + 
  coord_flip()
```

Co ciekawe rÃ³wnieÅ¼ **standard mieszkania w przypadku Warszawy nie ma aÅ¼ tak znaczÄ…cego wpÅ‚ywu na cenÄ™**. DuÅ¼y popyt na wynajem w stolicy sprawia, Å¼e nawet przeciÄ™tne lub sÅ‚abej jakoÅ›ci mieszkania osiÄ…gajÄ… wysokie ceny, co rÃ³Å¼ni siÄ™ od sytuacji w innych miastach, gdzie standard ma wiÄ™ksze znaczenie.

### MateriaÅ‚ budynku

```{r material_wwa, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = buildingMaterial, y = price)) +
  geom_boxplot(fill = "grey") +
  labs(title = "Cena wynajmu a materiaÅ‚ budynku", x = "MateriaÅ‚ budynku", y = "Cena wynajmu") +
  coord_flip()
```

### OdlegÅ‚oÅ›Ä‡ od centrum

```{r centrum_wwa, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = centreDistance, y = price, color = city)) +
  geom_smooth(method = "loess", se = FALSE) +
  labs(
    title = "Cena wynajmu a odlegÅ‚oÅ›Ä‡ od centrum w Warszawie",
    x = "OdlegÅ‚oÅ›Ä‡ od centrum (km)",
    y = "Cena wynajmu",
    color = "Miasto"
  ) +
  theme_minimal()
```

W przypadku Warszawy zauwaÅ¼alna jest **silna zaleÅ¼noÅ›Ä‡ miÄ™dzy odlegÅ‚oÅ›ciÄ… od centrum a cenÄ… wynajmu mieszkaÅ„** â€“ im dalej od Å›rÃ³dmieÅ›cia, tym niÅ¼sze ceny.

Jest to charakterystyczny trend dla stolicy, gdzie centralne lokalizacje osiÄ…gajÄ… najwyÅ¼sze ceny, niezaleÅ¼nie od standardu mieszkania. Wynika to z prestiÅ¼u, dogodnej komunikacji, bliskoÅ›ci biurowcÃ³w oraz dostÄ™pu do szerokiej infrastruktury. W miarÄ™ oddalania siÄ™ od centrum, ceny stopniowo malejÄ….

### PiÄ™tro

```{r pietrko_ww1, echo=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = factor(floor), y = price)) +
  geom_boxplot(fill = "lightblue") +
  labs(
    title = "Cena wynajmu w zaleÅ¼noÅ›ci od piÄ™tra",
    x = "PiÄ™tro",
    y = "Cena wynajmu"
  ) +
  theme_minimal()
```

```{r pietro_wwa_2, echo=FALSE, message=FALSE, warning=FALSE}
avg_price_floor <- dane_do_wiz_wwa %>%
  group_by(floor) %>%
  summarise(mean_price = mean(price, na.rm = TRUE))

ggplot(avg_price_floor, aes(x = floor, y = mean_price)) +
  geom_line(color = "darkgreen", size = 1) +
  geom_point(color = "orange", size = 2) +
  labs(
    title = "Åšrednia Cena wynajmu w zaleÅ¼noÅ›ci od piÄ™tra",
    x = "PiÄ™tro",
    y = "Åšrednia Cena wynajmu"
  ) +
  theme_minimal()
```

**ZaleÅ¼noÅ›Ä‡ ceny wynajmu od piÄ™tra w przypadku Warszawy prezentuje siÄ™ trochÄ™ inaczej niÅ¼ w pozostaÅ‚ych miastach**. Tutaj najbardziej wyrÃ³Å¼niajÄ…cym siÄ™ pod wzglÄ™dem ceny jest piÄ™tro 16, na ktÃ³rym to sÄ… najdroÅ¼sze mieszkania Nie widaÄ‡, aÅ¼ tak wielkich rÃ³znic w cenach na piÄ™trach 0-11. Dopiero od piÄ™tra 11 do 15 widoczny jest lekki spadek cen.

```{r wyzszepietra_wwa, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(dane_do_wiz_wwa, aes(x = factor(floor))) +
  geom_histogram(stat = "count", fill = "skyblue", color = "black") +
  labs(
    title = "Liczba ofert mieszkaÅ„ na piÄ™trze",
    x = "PiÄ™tro",
    y = "Liczba mieszkaÅ„"
  ) +
  theme_minimal()
```

MoÅ¼na zauwaÅ¼yÄ‡ teÅ¼, Å¼e **wystÄ™puje znacznie wiÄ™cej mieszkaÅ„ na piÄ™trach 11 i wyÅ¼szych**

### Korelacja

```{r korelacja_waa, echo=FALSE}
ggcorr(
  data = dane_do_wiz_wwa %>% select(where(is.numeric)),
  method = c("pairwise.complete.obs", "pearson"),
  label = TRUE
) +
  theme(
    axis.text.x = element_text(hjust = 1),  # PrzesuniÄ™cie etykiet na osi X
    axis.text.y = element_text(hjust = 1)   # PrzesuniÄ™cie etykiet na osi Y
  )
```

Ponownie tylko dwie zmienne â€“ **liczba pokoi (rooms)** i **powierzchnia (squareMeters)** â€“ wykazujÄ… **silnÄ… korelacjÄ™ (dodatniÄ…) z cenÄ… wynajmu**.

WiÄ™kszoÅ›Ä‡ pozostaÅ‚ych zmiennych nie wykazuje silnej korelacji ani dodatniej, ani ujemnej z cenÄ…. Zmienne opisujÄ…ce odlegÅ‚oÅ›Ä‡ od rÃ³Å¼nych obiektÃ³w (np. restaurantDistance, schoolDistance, parkDistance) sÄ… mocno skorelowane miÄ™dzy sobÄ….

# *Statystyki opisowe*

```{r statystyki_opisowe, include=FALSE}
dane_do_statystyk <- dane_do_wiz %>%
  mutate(  
    hasParkingSpace = ifelse(hasParkingSpace == "yes", TRUE, FALSE),  
    hasBalcony = ifelse(hasBalcony == "yes", TRUE, FALSE),  
    hasElevator = ifelse(hasElevator == "yes", TRUE, FALSE),  
    hasSecurity = ifelse(hasSecurity == "yes", TRUE, FALSE),
    hasStorageRoom = ifelse(hasStorageRoom == "yes", TRUE, FALSE)
  ) %>%
  select(-contains("_imp"))

dane_do_statystyk$id <- as.factor(dane_do_statystyk$id)

categorical_vars <- c("city", "type", "ownership", "buildingMaterial", "condition")

dane_do_statystyk[categorical_vars] <- lapply(dane_do_statystyk[categorical_vars], as.factor)

numeric_vars <- c("squareMeters", "rooms", "floor", "floorCount", "buildYear", 
                  "latitude", "longitude", "centreDistance", "poiCount", 
                  "schoolDistance", "clinicDistance", "postOfficeDistance", 
                  "kindergartenDistance", "restaurantDistance", "collegeDistance", 
                  "pharmacyDistance", "price")

dane_do_statystyk[numeric_vars] <- lapply(dane_do_statystyk[numeric_vars], as.numeric)
```

```{r stat_opis, echo=TRUE}
kalkulacje_stat <- function(data, group_var) {
  data %>%
    group_by(city, {{ group_var }} ) %>%
    summarise(
      n = n(),
      Å›rednia = mean(price, na.rm = TRUE),
      mediana = median(price, na.rm = TRUE),
      odch_std = sd(price, na.rm = TRUE),
      wariancja = var(price, na.rm = TRUE),
      coeff_var = (odch_std / Å›rednia) * 100,
      skoÅ›noÅ›Ä‡ = skewness(price, na.rm = TRUE),
      kurtoza = kurtosis(price, na.rm = TRUE),
      IQR = IQR(price, na.rm = TRUE),
      sx = IQR / 2,
      coeff_varx = (sx / mediana) * 100,
      min = min(price, na.rm = TRUE),
      max = max(price, na.rm = TRUE),
      q10 = quantile(price, 0.1, na.rm = TRUE),
      q25 = quantile(price, 0.25, na.rm = TRUE),
      q50 = quantile(price, 0.5, na.rm = TRUE),
      q75 = quantile(price, 0.75, na.rm = TRUE),
      q95 = quantile(price, 0.95, na.rm = TRUE)
    ) %>%
    rename(group_value = {{ group_var }} )
}

print(kalkulacje_stat(dane_do_statystyk,), n = Inf, width = Inf)
```

ZdecydowaliÅ›my siÄ™ dodatkowo nie komplikowaÄ‡ wyÅ›wietlanych wynikÃ³w grupujÄ…c po dodatkowym warunku, gdyÅ¼ wyniki byÅ‚yby zbyt obszerne

## Wnioski

Warszawa zdecydowanie wyrÃ³Å¼nia siÄ™ na tle innych miast, Å›rednia cena (5090) **jest niemal 2x wyÅ¼sza niÅ¼ w wiÄ™kszoÅ›ci miast**, Mediana (4000) **jest znaczÄ…co niÅ¼sza od Å›redniej, co sugeruje obecnoÅ›Ä‡ wysokich outlierÃ³w**, odchylenie standardowe (2974) i wspÃ³Å‚czynnik zmiennoÅ›ci (58.4%) **wskazujÄ…, Å¼e ceny w Warszawie sÄ… wyjÄ…tkowo rÃ³Å¼norodne.**

Inne miasta rÃ³wnieÅ¼ w niektÃ³rych aspektach zaskakujÄ… - ciekawie prezentuje siÄ™ **wysoka kurtoza** dla Krakowa (7.00), GdaÅ„ska (6.22), Poznania (6.59) oraz WrocÅ‚awia (6.22) **ktÃ³ra wskazuje na "spiÄ™trzenie" cen wokÃ³Å‚ mediany** â€“ rynek moÅ¼e byÄ‡ skoncentrowany na klasie Å›redniej.

Warszawa (36.2%), Gdynia (29.3%) i Katowice (27.3%) **majÄ… najwyÅ¼szÄ… zmiennoÅ›Ä‡ w ujÄ™ciu rozstÄ™pu miÄ™dzykwartylowego**. Szczecin (13.5%), Radom (16%) i WrocÅ‚aw (17.2%) to rynki o **najmniejszych wahaniach cen w Å›rodkowej czÄ™Å›ci rozkÅ‚adu**.

**NajniÅ¼sze ceny** wystÄ…piÅ‚y w Radomiu (Å›rednia 1851), dodatkowo **jako jedyne analizowane miasto** wykazaÅ‚o ***ujemnÄ…*** skoÅ›noÅ›Ä‡ (-0.0827) Oznacza to, Å¼e wiÄ™kszoÅ›Ä‡ ofert jest droÅ¼sza od Å›redniej.

W przypadku Katowic **zidentyfikowano wysoki wspÃ³Å‚czynnik zmiennoÅ›ci** (45.6%) â€“ rynek moÅ¼e byÄ‡ **mocno zrÃ³Å¼nicowany** (np. stare kamienice vs. nowe inwestycje).

# *Wnioskowanie statystyczne*

```{r wniosk_stat_1, echo=FALSE}
suppressMessages(suppressWarnings({ggbetweenstats(
  data = dane_do_statystyk,
  x = city,
  y = price,
  type = "parametric",
  title = "czy cena siÄ™ rÃ³Å¼ni miÄ™dzy miastami",
  palette = "Set1"
)
}))
```

Ten model sprawdza, czy istnieje istotna statystycznie rÃ³Å¼nica w cenach miÄ™dzy rÃ³Å¼nymi miastami.\

Hipoteza zerowa (H0): Nie ma rÃ³Å¼nicy w cenach miÄ™dzy miastami.

Hipoteza alternatywna (HA): Istnieje rÃ³Å¼nica w cenach miÄ™dzy miastami.

BiorÄ…c pod uwagÄ™ ekstremalnie niskÄ… wartoÅ›Ä‡ p (1.99e-296), mamy mocne dowody na odrzucenie hipotezy zerowej (H0). To oznacza, Å¼e **istnieje istotna statystycznie rÃ³Å¼nica w cenach miÄ™dzy miastami.**

```{r wniosk_stat_2, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
suppressMessages(suppressWarnings({gghistostats(
  data = dane_do_statystyk,
  x = price,
  grouping.var = hasElevator,
  title = "czy posiadanie windy wpÅ‚ywa na cenÄ™ mieszkania"
)
}))
```

Ten model sprawdza, czy posiadanie windy wpÅ‚ywa na cenÄ™ mieszkania.

Hipoteza zerowa (H0): Posiadanie windy nie wpÅ‚ywa na cenÄ™ mieszkania.

Hipoteza alternatywna (HA): Posiadanie windy wpÅ‚ywa na cenÄ™ mieszkania.

BiorÄ…c pod uwagÄ™ ekstremalnie niskÄ… wartoÅ›Ä‡ p (0.00), mamy mocne dowody na odrzucenie hipotezy zerowej (H0). **To oznacza, Å¼e posiadanie windy ma istotny statystycznie wpÅ‚yw na cenÄ™ mieszkania.**

```{r wniosk_stat_3, echo=FALSE}
ggscatterstats(
  data = dane_do_statystyk,
  x = squareMeters,
  y = price,
  title = "cena vs metraÅ¼ mieszkania"
)
```

Ten model sprawdza zaleÅ¼noÅ›Ä‡ miÄ™dzy cenÄ… mieszkaÅ„ a ich metraÅ¼em.

Hipoteza zerowa (H0): Nie ma korelacji miÄ™dzy cenÄ… mieszkaÅ„ a ich metraÅ¼em.

Hipoteza alternatywna (HA): Istnieje korelacja miÄ™dzy cenÄ… mieszkaÅ„ a ich metraÅ¼em.

BiorÄ…c pod uwagÄ™ ekstremalnie niskÄ… wartoÅ›Ä‡ p (0.00) oraz wysoki wspÃ³Å‚czynnik korelacji (0.78), mamy mocne dowody na odrzucenie hipotezy zerowej (H0). **To oznacza, Å¼e istnieje istotna statystycznie korelacja miÄ™dzy cenÄ… mieszkaÅ„ a ich metraÅ¼em.**

```{r wniosk_stat_4, echo=FALSE}
gghistostats(
  data = dane_do_statystyk,
  x = price,
  grouping.var = buildingMaterial,
  title = "Czy materiaÅ‚, z ktÃ³rego zbudowano budynek, wpÅ‚ywa na cenÄ™ mieszkania?"
)
```

Ten model sprawdza, czy materiaÅ‚, z ktÃ³rego zbudowano budynek, wpÅ‚ywa na cenÄ™ mieszkania.

Hipoteza zerowa (H0): MateriaÅ‚ budowlany nie wpÅ‚ywa na cenÄ™ mieszkania.

Hipoteza alternatywna (HA): MateriaÅ‚ budowlany wpÅ‚ywa na cenÄ™ mieszkania.

BiorÄ…c pod uwagÄ™ ekstremalnie niskÄ… wartoÅ›Ä‡ p (0.00), mamy mocne dowody na odrzucenie hipotezy zerowej (H0). **To oznacza, Å¼e materiaÅ‚, z ktÃ³rego zbudowano budynek, ma istotny statystycznie wpÅ‚yw na cenÄ™ mieszkania.**

```{r wniosk_stat_5, echo=FALSE}
ggbetweenstats(
  data = dane_do_statystyk,
  x = condition,
  y = price,
  type = "parametric",
  title = "WpÅ‚yw stanu mieszkania na cenÄ™"
)
```

Ten model sprawdza wpÅ‚yw stanu mieszkania na jego cenÄ™.

Hipoteza zerowa (H0): Stan mieszkania nie wpÅ‚ywa na jego cenÄ™.

Hipoteza alternatywna (HA): Stan mieszkania wpÅ‚ywa na jego cenÄ™.

BiorÄ…c pod uwagÄ™ wysokÄ… wartoÅ›Ä‡ p (0.56) oraz zerowÄ… wielkoÅ›Ä‡ efektu (ğœ‚ğ‘2=0.00), nie mamy dowodÃ³w na odrzucenie hipotezy zerowej (H0). **To oznacza, Å¼e stan mieszkania nie ma istotnego statystycznie wpÅ‚ywu na jego cenÄ™.**

# *Podsumowanie*

W trakcie analizy przeszliÅ›my przez kilka istotnych etapÃ³w. Na poczÄ…tku zaÅ‚adowaliÅ›my dane i dokonaliÅ›my ich wstÄ™pnej eksploracji. SprawdziliÅ›my, czy nie brakuje wartoÅ›ci, a takÅ¼e czy zmienne majÄ… poprawne formaty. NastÄ™pnie przeprowadziliÅ›my czyszczenie danych, aby uniknÄ…Ä‡ bÅ‚Ä™dÃ³w w dalszej analizie.

Potem przeszliÅ›my do wizualizacji danych oraz analizy statystycznej, co pomogÅ‚o nam dostrzec kluczowe wzorce i zaleÅ¼noÅ›ci. W dalszej czÄ™Å›ci sprawdziliÅ›my rÃ³Å¼ne modele i testy statystyczne, aby zweryfikowaÄ‡, ktÃ³re czynniki majÄ… realny wpÅ‚yw na ceny mieszkaÅ„.

## **Wnioski z analizy:**

1.  **Warszawa znaczÄ…co odstaje od reszty miast**, dlatego zdecydowaliÅ›my siÄ™ analizowaÄ‡ jÄ… osobno. Popyt na mieszkania w stolicy jest na tyle duÅ¼y, Å¼e wiele czynnikÃ³w, ktÃ³re majÄ… duÅ¼e znaczenie w innych miastach, w Warszawie odgrywa mniejszÄ… rolÄ™.

2.  **NajdroÅ¼sze miasta poza WarszawÄ… to KrakÃ³w, WrocÅ‚aw i GdaÅ„sk**. Te rynki charakteryzujÄ… siÄ™ wysokimi cenami mieszkaÅ„, choÄ‡ nadal sÄ… one niÅ¼sze niÅ¼ w stolicy.

3.  **NajwiÄ™kszy wpÅ‚yw na cenÄ™ ma lokalizacja oraz odlegÅ‚oÅ›Ä‡ od centrum**. Im bliÅ¼ej Å›cisÅ‚ego centrum, tym ceny sÄ… wyÅ¼sze, a rÃ³Å¼nice mogÄ… byÄ‡ bardzo duÅ¼e. To potwierdza, Å¼e w kontekÅ›cie rynku nieruchomoÅ›ci lokalizacja pozostaje kluczowym czynnikiem.

4.  **Udogodnienia w budynku (np. winda, monitoring, miejsce parkingowe) nie majÄ… znaczÄ…cego wpÅ‚ywu na cenÄ™**. Okazuje siÄ™, Å¼e kupujÄ…cy lub wynajmujÄ…cy kierujÄ… siÄ™ przede wszystkim lokalizacjÄ…, a dodatkowe udogodnienia nie podbijajÄ… cen tak bardzo, jak moÅ¼na by siÄ™ spodziewaÄ‡.

5.  **PiÄ™tro ma wpÅ‚yw na cenÄ™, ale nie jest to zaleÅ¼noÅ›Ä‡ liniowa**. Ceny rosnÄ… wraz z wysokoÅ›ciÄ…, ale tylko do pewnego momentu â€“ w bardzo wysokich budynkach mieszkania na najwyÅ¼szych piÄ™trach potrafiÄ… byÄ‡ taÅ„sze niÅ¼ te na Å›rednich kondygnacjach. WyjÄ…tkiem sÄ… luksusowe apartamenty na ostatnich piÄ™trach, ktÃ³re majÄ… znaczÄ…co wyÅ¼sze ceny.

6.  **Powierzchnia mieszkania oraz liczba pokoi majÄ… istotny wpÅ‚yw na cenÄ™, ale zaleÅ¼noÅ›Ä‡ nie jest wprost proporcjonalna**. Cena za metr kwadratowy spada wraz ze wzrostem powierzchni, co oznacza, Å¼e wiÄ™ksze mieszkania sÄ… relatywnie taÅ„sze w przeliczeniu na jednostkÄ™ powierzchni niÅ¼ kawalerki. Liczba pokoi rÃ³wnieÅ¼ wpÅ‚ywa na cenÄ™ â€“ mieszkania dwupokojowe sÄ… czÄ™sto bardziej atrakcyjne niÅ¼ kawalerki, ale powyÅ¼ej trzech pokoi rÃ³Å¼nice cenowe siÄ™ wypÅ‚aszczajÄ….

7.  **Typ budynku ma znaczenie â€“ mieszkania w nowym budownictwie sÄ… wyraÅºnie droÅ¼sze niÅ¼ w starych blokach**. Budynki z wielkiej pÅ‚yty majÄ… niÅ¼sze ceny niÅ¼ nowoczesne apartamentowce, a kamienice mogÄ… mieÄ‡ zarÃ³wno bardzo wysokie, jak i niskie ceny w zaleÅ¼noÅ›ci od standardu i lokalizacji.

8.  **W Warszawie wpÅ‚yw poszczegÃ³lnych czynnikÃ³w jest sÅ‚abszy niÅ¼ w innych miastach**. Ogromny popyt sprawia, Å¼e ceny sÄ… wysokie niemal w kaÅ¼dej lokalizacji, a czynniki takie jak piÄ™tro czy udogodnienia majÄ… mniejsze znaczenie niÅ¼ gdzie indziej.

9.  **ZidentyfikowaliÅ›my pewne niespodziewane wzorce**, np. w niektÃ³rych lokalizacjach ceny wydajÄ… siÄ™ niÅ¼sze, niÅ¼ wynikaÅ‚oby to z odlegÅ‚oÅ›ci od centrum. MoÅ¼e to oznaczaÄ‡, Å¼e istniejÄ… dodatkowe czynniki wpÅ‚ywajÄ…ce na ceny, ktÃ³re nie zostaÅ‚y uwzglÄ™dnione w modelu, np. haÅ‚as, infrastruktura czy prestiÅ¼ danej okolicy.
